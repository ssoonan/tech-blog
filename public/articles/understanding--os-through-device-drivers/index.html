<!DOCTYPE html>
<html lang="en">

<head>
  <title>
  The Cost of Simplicity: Understanding OS Abstraction through Device Drivers · Ssoonan&#39;s Tech Blog
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="Ssoonan">
<meta name="description" content="Exploring the hidden complexity behind a simple LED control through Linux Device Drivers and why it matters in the era of K8s and NPUs.">
<meta name="keywords" content="blog,developer,personal,technology">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="The Cost of Simplicity: Understanding OS Abstraction through Device Drivers">
  <meta name="twitter:description" content="Exploring the hidden complexity behind a simple LED control through Linux Device Drivers and why it matters in the era of K8s and NPUs.">

<meta property="og:url" content="https://ssoonan.com/articles/understanding--os-through-device-drivers/">
  <meta property="og:site_name" content="Ssoonan&#39;s Tech Blog">
  <meta property="og:title" content="The Cost of Simplicity: Understanding OS Abstraction through Device Drivers">
  <meta property="og:description" content="Exploring the hidden complexity behind a simple LED control through Linux Device Drivers and why it matters in the era of K8s and NPUs.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="articles">
    <meta property="article:published_time" content="2026-01-19T00:00:00+00:00">
    <meta property="article:modified_time" content="2026-01-19T00:00:00+00:00">
    <meta property="article:tag" content="OS">
    <meta property="article:tag" content="Linux">
    <meta property="article:tag" content="Kernel">
    <meta property="article:tag" content="Device Driver">
    <meta property="article:tag" content="Getting-Started">




<link rel="canonical" href="https://ssoonan.com/articles/understanding--os-through-device-drivers/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.min.4b392a85107b91dbdabc528edf014a6ab1a30cd44cafcd5325c8efe796794fca.css" integrity="sha256-SzkqhRB7kdvavFKO3wFKarGjDNRMr81TJcjv55Z5T8o=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css" integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin="anonymous" media="screen" />
  



 




<link rel="icon" type="image/svg+xml" href="/images/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="https://ssoonan.com/">
      Ssoonan&#39;s Tech Blog
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/articles/">Articles</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/thoughts/">Thoughts</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/projects/">Projects</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/">About</a>
            </li>
          
        
        
          
          
          
            
          
            
              
                <li class="navigation-item menu-separator">
                  <span>|</span>
                </li>
                
              
              <li class="navigation-item">
                <a href="/ko/">한국어</a>
              </li>
            
          
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container page">
  <article>
    <header>
      <h1 class="title">
        <a class="title-link" href="https://ssoonan.com/articles/understanding--os-through-device-drivers/">
          The Cost of Simplicity: Understanding OS Abstraction through Device Drivers
        </a>
      </h1>
    </header>

    <h3 id="the-hidden-side-of-simplicity">
  The Hidden Side of Simplicity
  <a class="heading-link" href="#the-hidden-side-of-simplicity">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>Before I dove deep into Operating Systems in graduate school, I experimented with Embedded Linux by controlling an LED on a Raspberry Pi. Even though fiddling with a breadboard was a bit tedious, the code itself was deceptively simple. One line of Python was all it took:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Python" data-lang="Python"><span style="display:flex;"><span><span style="color:#f92672">import</span> RPi.GPIO <span style="color:#66d9ef">as</span> GPIO
</span></span><span style="display:flex;"><span>GPIO<span style="color:#f92672">.</span>output(<span style="color:#ae81ff">17</span>, GPIO<span style="color:#f92672">.</span>HIGH)  <span style="color:#75715e"># Turn on LED</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Back then, I didn&rsquo;t think much beyond that line. But through my research into system software, I&rsquo;ve realized that behind this simple command lies a massive abstraction layer represented by System Calls and Device Drivers. Implementing this from scratch in the kernel requires hundreds of lines of code.</p>
<p>Interestingly, in a bare-metal environment like Arduino, this complexity doesn&rsquo;t exist. So, why is LED control so &ldquo;difficult&rdquo; on an OS? And why did this complexity evolve in the first place?</p>
<h3 id="the-essence-of-a-device-driver-the-os-is-the-problem">
  The Essence of a Device Driver: The OS is the &ldquo;Problem&rdquo;
  <a class="heading-link" href="#the-essence-of-a-device-driver-the-os-is-the-problem">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>A Device Driver is code that allows the OS to control hardware. While we often define it simply as &ldquo;hardware access code,&rdquo; that misses the point. The complexity of a driver stems less from the hardware itself and more from the structural requirements of the OS environment.</p>
<p>A modern OS environment has three fundamental characteristics:</p>
<ul>
<li>Multitasking: Dozens of processes run concurrently.</li>
<li>Protection: Mechanisms must prevent a buggy process from crashing other processes or the entire system.</li>
<li>Abstraction: A unified interface is required to control diverse devices.</li>
</ul>
<p>These requirements necessitate the split between Kernel Space and User Space. Applications run in user space and cannot directly access hardware. Whether it&rsquo;s reading a JSON file, sending a network packet, or lighting an LED, the application must &ldquo;request&rdquo; a privileged entity to do it.</p>
<p>We call this request a System Call. Much like a REST API in web development, the Kernel exposes an interface. When an application triggers a system call, the CPU switches to kernel mode, executes a predefined handler, and performs the hardware access safely.</p>
<p><img src="https://linux-kernel-labs.github.io/refs/heads/master/_images/ditaa-48374873962ca32ada36c14ab9a83b60f112a1e0.png" alt="System Call Flow Diagram"></p>
<p><em>Figure 1: System Call Flow from User Space to Device Driver</em></p>
<blockquote>
<p>While this flow varies by kernel type, I am assuming a Monolithic Kernel like Linux for this discussion.</p>
</blockquote>
<p>The Kernel itself doesn&rsquo;t inherently know how to talk to every SSD, GPU, or NPU. Hardware manufacturers must provide the &ldquo;manual&rdquo;—this is the <strong>Device Driver</strong>. To keep things standardized, Linux exposes these drivers through the file system.</p>
<p>You’ve likely heard the phrase <em>&ldquo;Everything is a file.&rdquo;</em> When you install an NVIDIA driver, the GPU appears as <code>/dev/nvidia0</code>. You can then use standard commands like <code>open()</code> and <code>read()</code> (which are system calls) to interact with the GPU. This abstraction is what allows complex hardware to be managed through a familiar interface.</p>
<p>This interface is exactly what Figure 1 illustrates. When your application makes a request—whether it&rsquo;s turning on an LED, reading from a disk, or sending network data—that request crosses the System Call Interface boundary. The CPU transitions from user mode to kernel mode, routes the request through the appropriate Device Driver, and finally executes the low-level hardware operation. The beauty of this design is that your application remains blissfully unaware of these details; it simply writes to <code>/dev/led</code> as if it were a regular file.</p>
<hr>
<h3 id="real-world-implementation-beyond-the-python-script">
  Real-World Implementation: Beyond the Python Script
  <a class="heading-link" href="#real-world-implementation-beyond-the-python-script">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>To control an LED at the system level, as demonstrated earlier, we actually need to write two programs: the Device Driver (the bridge) and the Application (the user).</p>
<p>A basic LED driver structure in C looks like this:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">led_open</span>(<span style="color:#66d9ef">struct</span> inode <span style="color:#f92672">*</span>inode, <span style="color:#66d9ef">struct</span> file <span style="color:#f92672">*</span>file) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Initialization when the device file is opened
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">ssize_t</span> <span style="color:#a6e22e">led_write</span>(<span style="color:#66d9ef">struct</span> file <span style="color:#f92672">*</span>filep, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> __user <span style="color:#f92672">*</span>buffer, <span style="color:#66d9ef">size_t</span> len, <span style="color:#66d9ef">loff_t</span> <span style="color:#f92672">*</span>offset)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">char</span> command;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">spin_lock</span>(<span style="color:#f92672">&amp;</span>led_lock);
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Safely copy data from user space to kernel space
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">copy_from_user</span>(<span style="color:#f92672">&amp;</span>command, buffer, <span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#f92672">-</span>EFAULT;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (command <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;1&#39;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">gpio_set_value</span>(LED_GPIO_PIN, <span style="color:#ae81ff">1</span>); <span style="color:#75715e">// LED ON
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    led_state <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>  } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (command <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;0&#39;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">gpio_set_value</span>(LED_GPIO_PIN, <span style="color:#ae81ff">0</span>); <span style="color:#75715e">// LED OFF
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    led_state <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">spin_unlock</span>(<span style="color:#f92672">&amp;</span>led_lock);
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>Why so much &ldquo;boilerplate&rdquo;?</p>
<ul>
<li><code>copy_from_user()</code>: Since User Space and Kernel Space use different virtual memory address spaces, the kernel cannot simply dereference a user-space pointer. We must explicitly copy the data for safety.</li>
<li><code>spin_lock()</code>: Because the OS is a multitasking environment, two processes might try to toggle the LED simultaneously. Without a lock, the hardware state becomes unpredictable.</li>
</ul>
<p>Once the driver is registered, the &ldquo;Application&rdquo; can be as simple as a shell script:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Bash" data-lang="Bash"><span style="display:flex;"><span><span style="color:#75715e"># Turn LED on</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;1&#34;</span> | sudo tee /dev/led
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Turn LED off</span>
</span></span><span style="display:flex;"><span>echo <span style="color:#e6db74">&#34;0&#34;</span> | sudo tee /dev/led
</span></span></code></pre></td></tr></table>
</div>
</div><p>Through this shell script, we can observe the LED turning on or blinking.</p>
<p><img src="/images/output.gif" alt="LED Toggle Output"></p>
<hr>
<h3 id="the-complexity-of-the-asynchronous-world-interrupts">
  The Complexity of the Asynchronous World: Interrupts
  <a class="heading-link" href="#the-complexity-of-the-asynchronous-world-interrupts">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>The example above covers synchronous tasks (the process initiates the action). But hardware is often asynchronous. Think of a keyboard or a network card; the hardware tells the CPU when an event happens. This is an Interrupt.</p>
<p>In an OS scheduling dozens of processes, we cannot have one process &ldquo;polling&rdquo; the hardware (looping constantly to check for updates), as this wastes CPU cycles. Instead, the process goes to sleep, and an interrupt &ldquo;wakes&rdquo; it up.</p>
<p>If we add a button to our LED circuit to toggle the state, we need an Interrupt Handler:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-C" data-lang="C"><span style="display:flex;"><span><span style="color:#66d9ef">static</span> <span style="color:#66d9ef">irqreturn_t</span> <span style="color:#a6e22e">button_irq_handler</span>(<span style="color:#66d9ef">int</span> irq, <span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>dev_id)
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">spin_lock_irqsave</span>(<span style="color:#f92672">&amp;</span>led_lock, flags);
</span></span><span style="display:flex;"><span>  led_state <span style="color:#f92672">=</span> <span style="color:#f92672">!</span>led_state;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">gpio_set_value</span>(LED_GPIO_PIN, led_state);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">spin_unlock_irqrestore</span>(<span style="color:#f92672">&amp;</span>led_lock, flags);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> IRQ_HANDLED;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>Notice <code>spin_lock_irqsave()</code>. We must disable interrupts while holding the lock. If an interrupt occurs while a process already holds the led_lock, the handler would wait forever for the lock to be released, but the process can&rsquo;t release the lock until the handler finishes—a classic deadlock.</p>
<hr>
<h3 id="conclusion-complexity-is-the-foundation-of-orchestration">
  Conclusion: Complexity is the Foundation of Orchestration
  <a class="heading-link" href="#conclusion-complexity-is-the-foundation-of-orchestration">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h3>
<p>The complexity of a device driver isn&rsquo;t &ldquo;bloat.&rdquo; It is the price we pay for a General-purpose environment where resources are shared, protected, and abstracted.</p>
<p>This &ldquo;meaningful complexity&rdquo; is becoming even more critical in the era of AI and Software-Defined Vehicles (SDV). Look at NVIDIA CUDA. AI developers use the same PyTorch code for a GTX 1080 or an H100. This is only possible because the CUDA driver abstracts the hardware differences.</p>
<p>To truly master GPU and NPU utilization today, one must understand the driver layer. You don&rsquo;t need to memorize every line of a GPU driver, but you must understand how requests flow through the kernel to know which metrics to monitor and how to manage bottlenecks.</p>
<p>In my own research, analyzing the Hailo NPU device driver and its interaction with the hailort library was the key to developing a Kubernetes Device Plugin that actually performs in real-time edge environments.</p>
<p>Ultimately, the ability to navigate this complexity is what separates a user of systems from an engineer who controls them. Whether it&rsquo;s a single LED or a cluster of 1,000 NPU nodes, the fundamental principles of the OS remain the same.</p>
<p>In my next post, I’ll share how these kernel-level insights translate into orchestrating NPU resources within Kubernetes.</p>

  </article>
</section>

  

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
      2025 -
    
    2026
     Ssoonan 
    ·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js" integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script>
  

  

  


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>
</html>
